<!-- @meta -->

<title>Edit Article</title>

<!-- @meta -->

<!-- @head_tags -->

<style>
  .box23 {

    margin: 66px auto;

    width: 950px;

    background: #fff;

    border-radius: 5px;

    text-align: left;

    padding: 15px;

  }



  h1 {
    margin-top: 0;
    text-align: left;
    max-width: 100%;
  }



  .label {

    margin-top: 35px;

  }



  .container div input,

  .selectric,

  .input,

  .btn {

    padding: 13px;

    font-size: 14px;

  }



  .btn {

    width: 100px;

    text-align: center;

  }



  html {

    overflow-x: hidden;

  }



  .cke_reset_all {

    background: #f7f7f7 !important;

  }



  .status {

    font-weight: bold;

    height: 30px;

    width: 55px;

    padding: 5px;

    font-size: 15px;

    text-align: center;

    border-radius: 3px;

    margin-bottom: 10px;

  }





  .textareacontact {

    font-family: 'Open Sans';

  }



  .imgcaption {

    background-color: #ccc;

    padding: 5px;

    font-weight: 600;

    font-size: 15px;

  }



  .input {

    width: 100%;

    border-radius: 6px;

    border: 1px solid #BEBEBE;

  }



  .emailsuccess {

    background: #a3ffa3;

    padding: 8px;

    -webkit-border-radius: 5px;

    -moz-border-radius: 5px;

    border-radius: 5px;

  }



  .color3 {

    border-radius: 50px;

  }

  /* overlap div */

  .mainDiv {
    width: 150px;
    height: 150px;
    background: #ccc;
    position: relative;
  }

  .mainDiv .image {
    text-align: center;
    position: relative;
  }

  .info {
    width: 100%;
    position: absolute;
    bottom: 0;
    left: 0;
    z-index: 1;
    background-color: black;
    transition: opacity 300ms;
    opacity: 0;
    padding: 12px;
  }

  .info a {
    display: block;
    text-align: center;
    border: solid 1px white;
    border-radius: 5px;
    margin-bottom: 5px;
    padding: 5px;
  }

  .info a:hover {
    background: white;
    color: black !important;
  }

  .mainDiv:hover .info {
    opacity: 1;
  }

  /* overlap div */

  input[type="file"] {
    display: none;
  }

  label {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background: transparent;
    border: 1px dashed grey;
    height: 100px;
    width: 100px;
    color: #000;
    margin: 5px 0 0;
    font-size: 18px;
    cursor: pointer;
  }

  .label-blue {
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;
    gap: 8px;
    background: #09B5FF;
    border: none;
    border-radius: 10px;
    height: 40px;
    width: 125px;
    color: #FFF;
    margin: 5px 0 0;
    font-size: 14px;
    cursor: pointer;
  }

  .loader {
    display: none;
    position: absolute;
    margin-top: 25px;
    left: 23%;
    /* top: 50%; */
    z-index: 1;
    width: 80px;
    height: 80px;
    /* margin: -76px 0 0 -76px; */
    border: 10px solid #f3f3f3;
    border-radius: 50%;
    border-top: 10px solid #3498db;
    -webkit-animation: spin 2s linear infinite;
    animation: spin 2s linear infinite;
    /* background: #aaa; */
    /* box-shadow: 0 0 0 100vw #aaa; */
  }

  @-webkit-keyframes spin {
    0% {
      -webkit-transform: rotate(0deg);
    }

    100% {
      -webkit-transform: rotate(360deg);
    }
  }

  @keyframes spin {
    0% {
      transform: rotate(0deg);
    }

    100% {
      transform: rotate(360deg);
    }
  }
</style>



<!-- @head_tags -->

<!-- @script_tags -->



<script src="/common/ckeditor/ckeditor.js"></script>



<script>



  CKEDITOR.on('instanceReady', function (ev) { ev.editor.fire('contentDom'); config.extraAllowedContent = '*(*)'; });



  CKEDITOR.replace('editor1', {

    width: '768px',

    contentsCss: "body {font-size: 15px;font-family:'Poppins';letter-spacing: .4px;}"

  });





  CKEDITOR.addCss('p.imgcaption{background-color:#ccc;padding:5px;font-weight:600;font-size:15px;font-family: arial;}');

  CKEDITOR.extraAllowedContent = '*(*)';



</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

<!-- @script_tags -->



<main>

  <div class="box23" style="display:flex;justify-content: space-between;align-items: center;">

    <a href="/admin/articles/">Â« Back</a>

    <a class="btn btn-primary color3" href="https://superviral.io{loc}/blog/{url}?testpreview=true&previewtime={timenow}" target="_blank">
      <span>
        <svg style="fill:white;vertical-align: text-top;" xmlns="http://www.w3.org/2000/svg" width="16" height="16"
          fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">
          <path
            d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13.133 13.133 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.133 13.133 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5c-2.12 0-3.879-1.168-5.168-2.457A13.134 13.134 0 0 1 1.172 8z">
          </path>
          <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"></path>
        </svg>
      </span>
      <span>
        PREVIEW
      </span>
    </a>
  </div>



  <form method="POST" enctype="multipart/form-data">

    <div class="box23">

      <h1>Edit: {title}</h1>
      {live}
      {message}


      <hr>



      <input type="hidden" name="id" value="{id}">



      <!-- @company_logo -->

      <!-- IF COMPANY IS SET, SHOW LOGO, CAN NOT BE CHANGED ONCE SET -->

      <!-- <img src="/admin/assets/icons/superviral.svg" alt="logo"> -->

      <!-- @company_logo -->



      <div class="label labelcontact">Country:</div>

      <select class="input inputcontact" name="country">
        <option disabled>Select a country</option>
        <option value="us">United States (US)</option>
        <option value="uk">United Kingdom (UK)</option>
      </select>

     {publishInput}

      <div class="label labelcontact">Your title:</div>

      <input class="input inputcontact" autocomplete="off" name="title" value="{title}" fdprocessedid="eqb8e">

      <div class="label labelcontact">URL:</div>

      <input class="input inputcontact" autocomplete="off" name="url" value="{url}">

      <div class="label labelcontact">Description:</div>

      <textarea class="input inputcontact textarea textareacontact" name="shortdesc">{shortdesc}</textarea>

      <div class="label labelcontact">Summary 1:</div>

      <input class="input inputcontact" autocomplete="off" name="summary1" value="{summary1}" fdprocessedid="to0z7q">

      <div class="label labelcontact">Summary 2:</div>

      <input class="input inputcontact" autocomplete="off" name="summary2" value="{summary2}" fdprocessedid="o5f6qk">

      <div class="label labelcontact">Summary 3:</div>

      <input class="input inputcontact" autocomplete="off" name="summary3" value="{summary3}" fdprocessedid="7uu9bl">

      <div class="label labelcontact">Author name:</div>

      <input class="input inputcontact" autocomplete="off" name="author_name" value="The Superviral Team" readonly fdprocessedid="unavk">

      <!-- <div class="label labelcontact">Author description:</div>

      <input class="input inputcontact" autocomplete="off" name="author_description" value="{author_description}"
        fdprocessedid="ip58se"> -->

      <div>
        <div class="label labelcontact">Article thumbnail:</div>
        <div style="display:flex;align-items: center;">
          <div style="display: flex;" id="thumbDivId">{articleTN}</div>
          <div id="loaderTN" class="loader"></div>
          <label class="label-blue" for="tnFile"><img src="/admin/assets/icons/add-photo.png" style="width: 20px;">Upload Image</label>
          <label class="label-blue" style="margin-left:20px;"><a target="_blank" href="/admin/articles/new/images/generate_tn.php?ids={id}&edit=true"><img src="/admin/assets/icons/add-photo.png" style="width: 20px;">Select AI Images</a></label>          
          <input class="input inputcontact" type="file" id="tnFile" onchange="uploadThumbImage();" name="article_tn">
        </div>
      </div>

      <!-- <div>
        <div class="label labelcontact">Author image:</div>
        <div style="display:flex;align-items: center;">
          <div style="display: flex;" id="authorDivId">{authorImg}</div>
          <div id="loaderAu" class="loader"></div>
          <label class="label-blue" for="file"><img src="/admin/assets/icons/add-photo.png" style="width: 20px;">Upload
            Image</label>
          <input class="input inputcontact" type="file" id="file"  name="author_image" onchange="uploadAuthorImage();">
        </div>
      </div> -->


      <div style="border: solid 3px black;margin-top: 35px;padding: 1rem;">
        
        <div class="label labelcontact" style="margin-top:0;">Article body images</div>
        <div style="display: flex;align-items: start;gap: 1rem;flex-wrap: wrap;margin-top: 19px;">
          <label for="article_image" style="height: 150px;width: 150px;margin:0;"><span
              style="font-size: 40px;">+</span>Add Image</label>
          <input class="input inputcontact" type="file" onchange="uploadArticleImage();" id="article_image">

          <div id="artcileImagesDivId" style="display: contents;">
            {articleImages}
          </div>
          <div id="loaderAI" class="loader"></div>
        </div>
      </div>

      <br><br>
      <div class="label labelcontact">Article:</div>



      <textarea class="ckeditor input inputcontact textarea textareacontact" cols="80" id="editor1" name="article"
        rows="10">{article}</textarea>



      <div style="height:330px;position:relative;">



        <input type="submit" class="btn btn-primary color3" name="submit" value="Save"
          style="float:left; margin-top: 15px;{saveBtnCss}">

        {publishBtn}



        <input type="submit" class="btn color3" name="submit" value="Delete"
          style="left:0;bottom:0px;position:absolute;background:grey;{deleteBtnCss}"
          onclick="return confirm('Are you sure you want to delete this article?');">



      </div>



  </form>

  <form method="POST">

  </form>


  <script>

    function copy(id) {
      var copyText = document.getElementById('copyImg' + id);
      copyText.select();
      copyText.setSelectionRange(0, 99999);
      navigator.clipboard
        .writeText('[img src="' + copyText.value + '"]')
        .then(() => {
          alert("successfully copied");
        })
        .catch(() => {
          alert("something went wrong");
        });
    }

    function uploadArticleImage() {

      var file_data = $('#article_image').prop('files')[0];
      
      var imgpath=document.getElementById('article_image');
      if (!imgpath.value==""){
        var img=imgpath.files[0].size;
        var imgsize=img/1024; 
        if(imgsize > 2048){
          $('#artcileImagesDivId').append("Image Size is too large, allowed 2MB file only"); 
          return;
        }
       
      }

      var form_data = new FormData();  // Create a FormData object
      form_data.append('article_image', file_data);  // Append all element in FormData  object
      form_data.append('id', {id});  // Append all element in FormData  object
      form_data.append('submit', 'Upload');  // Append all element in FormData  object
      $('#loaderAI').show();
      $.ajax({
        url: 'editarticle.php',     // point to server-side PHP script 
        dataType: 'text',           // what to expect back from the PHP script, if anything
        cache: false,
        contentType: false,
        processData: false,
        data: form_data,
        type: 'post',
         success: function (output) {
          $('#loaderAI').hide();
          if(output != "Image Size is too large, allowed 2MB file only" && output != "File type is not allowed")
          $('#artcileImagesDivId').html(output);            // display response from the PHP script, if any
          else
          $('#artcileImagesDivId').append(output); 
        }
      });
      $('#article_image').val('');
    }

    function uploadThumbImage() {

      var file_data = $('#tnFile').prop('files')[0];
      var form_data = new FormData();  // Create a FormData object
      form_data.append('article_tn', file_data);  // Append all element in FormData  object
      form_data.append('id', {id});  // Append all element in FormData  object
      form_data.append('submit', 'thumbImage');  // Append all element in FormData  object
      $('#loaderTN').show();
      $.ajax({
        url: 'editarticle.php',     // point to server-side PHP script 
        dataType: 'text',           // what to expect back from the PHP script, if anything
        cache: false,
        contentType: false,
        processData: false,
        data: form_data,
        type: 'post',
        success: function (output) {
          $('#loaderTN').hide();
          $('#thumbDivId').html(output);            // display response from the PHP script, if any
        }
      });
      $('#tnFile').val('');
    }

    function uploadAuthorImage() {

      var file_data = $('#file').prop('files')[0];
      var form_data = new FormData();  // Create a FormData object
      form_data.append('author_image', file_data);  // Append all element in FormData  object
      form_data.append('id', {id});  // Append all element in FormData  object
      form_data.append('submit', 'authorImage');  // Append all element in FormData  object
      $('#loaderAu').show();
      $.ajax({
        url: 'editarticle.php',     // point to server-side PHP script 
        dataType: 'text',           // what to expect back from the PHP script, if anything
        cache: false,
        contentType: false,
        processData: false,
        data: form_data,
        type: 'post',
        success: function (output) {
          $('#loaderAu').hide();
          $('#authorDivId').html(output);            // display response from the PHP script, if any
        }
      });
      $('#file').val('');
    }

  </script>






</main>
